!function(b){if("object"==typeof exports){module.exports=b()}else{if("function"==typeof define&&define.amd){define(b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.IMVVM=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(n,l){if(!k[n]){if(!f[n]){var i=typeof require=="function"&&require;if(!l&&i){return i(n,!0)}if(e){return e(n,!0)}throw new Error("Cannot find module '"+n+"'")}var m=k[n]={exports:{}};f[n][0].call(m.exports,function(o){var p=f[n][1][o];return g(p?p:o)},m,m.exports,c,f,k,h)}return k[n].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(h,g,f){var e=h("./src/imvvm.js");g.exports=e},{"./src/imvvm.js":3}],2:[function(h,g,f){var e=h("./utils");var i=e.extend;f.getInitialState=function(m,n,t,l){if(typeof t!=="function"){throw new TypeError()}l===void (0)?true:l;var B,s={},q={},C,j={},y={};var w={};var p={};var o=function(S,D,E,I){var L={},J={},O;if(typeof E==="function"){I=E;E={}}D=D||{};O=Object.keys(D);if(Object.getPrototypeOf(D).constructor.classType==="DomainViewModel"){L=i(D);J=D.previousState;for(var U in C){L[U]=new q[U](L)}for(var V in C){if(C.hasOwnProperty(V)){for(var G in j[V]){if(j[V].hasOwnProperty(G)){L[V].state[j[V][G]]=(G in C)?i(L[G].state):L[G]}}}}}else{if(!!O.length){if(S===m){L=i(D)}else{L[S]=i(D)}}w=i(L,w,E);transStateKeys=Object.keys(w);if(transStateKeys.length===0){return}if(typeof I==="function"){I();return}var k;var F=transStateKeys.length-1;for(k=F;k>=0;k--){if(transStateKeys[k] in C){L[transStateKeys[k]]=i(s[transStateKeys[k]],w[transStateKeys[k]]);L[transStateKeys[k]]=new q[transStateKeys[k]](L)}else{L[transStateKeys[k]]=w[transStateKeys[k]]}}p=i(p,L);L=i(s,p);w={};for(k=F;k>=0;k--){if(transStateKeys[k] in y){for(var R in y[transStateKeys[k]]){if(y[transStateKeys[k]].hasOwnProperty(R)){if(O.indexOf(R)!==-1){var H=y[transStateKeys[k]][R];for(var M in H){if(H.hasOwnProperty(M)){w=i(w,H[M].call(s[M],L[transStateKeys[k]][R],s[transStateKeys[k]][R],R,transStateKeys[k]))}}}}}}}if(!!Object.keys(w).length){o(void (0),{},w);return}var T=Object.keys(p);var Q=T.length-1;var K;var N,P;for(k=Q;k>=0;k--){if(S===m){if(T[k] in j[m]){for(N in j[m][T[k]]){if(j[m][T[k]].hasOwnProperty(N)){L[N].state[j[m][T[k]][N]]=L[T[k]]}if(N in j){for(P in j[N]){if(j[N].hasOwnProperty(P)){L[N].state[j[N][P]]=(P in C)?i(L[P].state):L[P]}}}}}}else{if(T[k] in j){for(N in j[T[k]]){if(j[T[k]].hasOwnProperty(N)){L[T[k]].state[j[T[k]][N]]=(N in C)?i(L[N].state):L[N]}if(N in j){for(P in j[N]){if(j[N].hasOwnProperty(P)){L[N].state[j[N][P]]=(P in C)?i(L[P].state):L[P]}}}}}}}J=s}if(!!J){Object.freeze(J)}s=new B(L,J,l);Object.freeze(s);Object.freeze(s.state);t(s);w={};p={};return s};B=n.call(this,o.bind(this,m));s=new B(void (0),void (0),l,true);s.state=s.state||{};C=s.getDomainDataContext();var x;var u;var A;var z;for(var r in C){if(C.hasOwnProperty(r)){q[r]=C[r].call(this,o.bind(this,r)).bind(this,r);s.state[r]=new q[r](s.state);if("getWatchedState" in s[r]){x=s[r].getWatchedState();for(u in x){if(x.hasOwnProperty(u)){if(u in C||u in s.state){if("alias" in x[u]){if(!(r in j)){j[r]={}}j[r][u]=x[u].alias;if(!(u in C)){if(!(m in j)){j[m]={}}if(!(r in j[m])){j[m][u]={}}j[m][u][r]=x[u].alias}}for(A in x[u].fields){if(x[u].fields.hasOwnProperty(A)){if(u in C){z={};if(!(u in y)){y[u]={}}z[A]={};z[A][r]=x[u].fields[A];y[u]=z}}}}}}}}}for(var r in C){if(C.hasOwnProperty(r)){for(var v in j[r]){if(j[r].hasOwnProperty(v)){s[r].state[j[r][v]]=(v in C)?i(s[v].state):s[v]}}}}s=new B(s,void (0),l);Object.freeze(s.state);Object.freeze(s);return s}},{"./utils":8}],3:[function(f,g,j){var k=f("./imvvmModel");var p=f("./imvvmViewModel");var i=f("./imvvmDomainViewModel");var r=f("./mixin");var q=f("./utils");var o=q.extend;var m=q.mixInto;var l=function(){};var h=function(){};var n=function(){};m(l,k.Mixin);m(h,p.Mixin);m(n,i.Mixin);var e={createClass:function(u,v,t){var y=function(){};y.prototype=new u();y.prototype.constructor=y;var x=y;var w=function(z){var A=new x();return A.construct.apply(w,arguments)};w.componentConstructor=y;y.ConvenienceConstructor=w;w.originalSpec=t;w.type=y;y.prototype.type=y;w.classType=v;y.prototype.classType=v;w.getDescriptor=function(){var D={};var C=this.prototype;var A={};var z=[];if("__processedObject__" in this.originalSpec){return this.originalSpec.__processedObject__}for(var B in this.originalSpec){if(this.originalSpec.hasOwnProperty(B)){if("get" in this.originalSpec[B]||"set" in this.originalSpec[B]){this.originalSpec[B].enumerable=true;if("viewModel" in this.originalSpec[B]){A[B]=this.originalSpec[B].viewModel;delete this.originalSpec[B].viewModel}else{if("kind" in this.originalSpec[B]){if(this.originalSpec[B].kind==="pseudo"){this.originalSpec[B].enumerable=false}else{z.push({fieldName:B,kind:this.originalSpec[B].kind})}delete this.originalSpec[B].kind}}D[B]=this.originalSpec[B]}else{C[B]=this.originalSpec[B]}}}if(!("extend" in C)){C.extend=q.extend}if(!!Object.keys(A).length){C.getDomainDataContext=function(){return A}}this.originalSpec.__processedObject__={descriptor:D,proto:C,originalSpec:this.originalSpec||{},freezeFields:z};return this.originalSpec.__processedObject__};return w}};var s={createModel:e.createClass.bind(this,l,"Model"),createViewModel:e.createClass.bind(this,h,"ViewModel"),createDomainViewModel:e.createClass.bind(this,n,"DomainViewModel"),mixin:r};g.exports=s},{"./imvvmDomainViewModel":4,"./imvvmModel":5,"./imvvmViewModel":6,"./mixin":7,"./utils":8}],4:[function(j,h,f){var e=j("./utils");var k=e.extend;var g=e.getDescriptor;var i={Mixin:{construct:function(m){var n=this.getDescriptor(this);n.proto.setState=m;var l=function(q,u,t,o){var s=n.freezeFields;var r=Object.create(n.proto,n.descriptor);if(q===void (0)&&("getInitialState" in r)){q=r.getInitialState.call(r)}else{if("state" in q){delete q.state;Object.defineProperty(r,"state",{configurable:true,enumerable:false,writable:true,value:q});q=k(q,r)}}Object.defineProperty(r,"state",{configurable:false,enumerable:false,writable:false,value:q});if(!!t&&!!u){Object.defineProperty(r,"previousState",{configurable:false,enumerable:false,writable:false,value:u})}for(var p=s.length-1;p>=0;p--){Object.freeze(r[s[p].fieldName])}return r};return l}}};h.exports=i},{"./utils":8}],5:[function(i,h,f){var e=i("./utils");var k=e.extend;var g=e.getDescriptor;var j={Mixin:{construct:function(m){var n=this.getDescriptor(this);n.stateChangedHandler=m;n.proto.__getDescriptor=function(){return n};var l=function(r,o){var s=n.freezeFields;var p=Object.create(n.proto,n.descriptor);if(r===void (0)){o=true}r=r||{};Object.defineProperty(p,"state",{configurable:true,enumerable:false,writable:true,value:r});r=k(r,p);if(o&&("getInitialState" in p)){r=k(r,p.getInitialState.call(p))}Object.defineProperty(p,"state",{configurable:false,enumerable:false,writable:false,value:r});for(var q=s.length-1;q>=0;q--){Object.freeze(p[s[q].fieldName])}return Object.freeze(p)};return l}}};h.exports=j},{"./utils":8}],6:[function(j,i,g){var f=j("./utils");var k=f.extend;var h=f.getDescriptor;var e={Mixin:{construct:function(m){var n=this.getDescriptor(this);n.proto.setState=m;var l=function(s,u){var r={};var t=n.freezeFields;var p=Object.create(n.proto,n.descriptor);var v,o;Object.defineProperty(p,"state",{configurable:true,enumerable:false,writable:true,value:r});if(u[s]===void (0)){if("getInitialState" in p){r=k(r,p.getInitialState.call(p))}}else{r=("state" in u[s]?u[s].state:u[s])}Object.defineProperty(p,"state",{configurable:false,enumerable:false,writable:false,value:r});for(var q=t.length-1;q>=0;q--){if(t[q].kind==="instance"){if(p[t[q].fieldName]){v=p[t[q].fieldName].__getDescriptor();o=Object.create(v.proto,v.descriptor);Object.defineProperty(o,"state",{configurable:false,enumerable:false,writable:false,value:p[t[q].fieldName].state});o.__proto__.setState=function(w,x){return v.stateChangedHandler.call(this,k(o.state,w),o.state,x)}.bind(p);Object.freeze(p[t[q].fieldName])}}else{Object.freeze(p[t[q].fieldName])}}return Object.freeze(p)};return l}}};i.exports=e},{"./utils":8}],7:[function(j,i,h){var f=j("./core");var e="__IMVVM__";var g={stateChangedHandler:function(k){this.setState({domainDataContext:k})},getInitialState:function(){var k=f.getInitialState(e,this.props.domainModel,this.stateChangedHandler,this.props.enableUndo);return{domainDataContext:k}}};i.exports=g},{"./core":2}],8:[function(h,g,f){var e={extend:function(){var j={};for(var l=0;l<arguments.length;l++){var m=arguments[l];for(var k in m){if(m.hasOwnProperty(k)){j[k]=m[k]}}}return j},mixInto:function(j,k){var i;for(i in k){if(!k.hasOwnProperty(i)){continue}j.prototype[i]=k[i]}}};g.exports=e},{}]},{},[1])(1)});