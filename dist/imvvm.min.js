!function(b){if("object"==typeof exports){module.exports=b()}else{if("function"==typeof define&&define.amd){define(b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.IMVVM=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(n,l){if(!k[n]){if(!f[n]){var i=typeof require=="function"&&require;if(!l&&i){return i(n,!0)}if(e){return e(n,!0)}throw new Error("Cannot find module '"+n+"'")}var m=k[n]={exports:{}};f[n][0].call(m.exports,function(o){var p=f[n][1][o];return g(p?p:o)},m,m.exports,c,f,k,h)}return k[n].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(h,g,f){var e=h("./src/imvvm.js");g.exports=e},{"./src/imvvm.js":3}],2:[function(h,g,f){var e=h("./utils");var i=e.extend;f.getInitialState=function(l,r,j,s,v,p){if(typeof v!=="function"){throw new TypeError()}var x=void 0,k={},w,o={};var q=function(B,F,D){var G=false,E,A;F=F||{};if(B===void 0){A=true;B={}}var C=function(I){var K={},J,H;if("dependsOn" in I){I.dependsOn.forEach(function(L){H={};J=L.property.split(".");J.forEach(function(N,M){if(M===0){H=B[N]}else{H=H?H[N]:void 0}});if("alias" in L){K[L.alias]=H}else{K[J.join("_")]=H}})}return K};for(var z in s){if(s.hasOwnProperty(z)){E=C(s[z]);if(A){B[z]=new k[z](B[z],E,F[z]).init(s[z].initArgs)}else{B[z]=new k[z](B[z],E,F[z])}if(D){if(G&&D.subscribers.indexOf(z)!==-1){E=C(s[D.name]);B[D.name]=new k[D.name](B[D.name],E,F[D.name])}G=G?G:z===D.name}}}return B};var n=function(z,A,I,E){var H,L={},G=void 0,K=void 0,F,D,J;if(z in o){F=Object.keys(A);D=F.length;J={};for(var C=0;C<D;C++){if(o[z][F[C]]){J[o[z][F[C]]]=true}}K={};K.name=z;K.subscribers=Object.keys(J);K=!!K.subscribers.length?K:void 0}var B=!!A?Object.getPrototypeOf(A).constructor.classType==="DomainModel":false;if(B){L=i(A.state);G=A.state.previousState}else{if(z!==l){L[z]=A;L=i(x.state,L)}else{if(E){L=i(q(),A)}else{L=i(x.state,A)}}G=x;L=q(L,x?x.state:void 0,K)}if(G){Object.freeze(G)}x=new y(L,p?void 0:G);H=Object.freeze(x.state);v(H,z,I);return H};var y=r.call(this,n.bind(this,l));for(var m in s){if(s.hasOwnProperty(m)){k[m]=s[m].viewModel.call(this,n.bind(this,m));if("dependsOn" in s[m]){for(var t=0,u=s[m].dependsOn.length;t<u;t++){w=s[m].dependsOn[t].property.split(".");if(w.length>1){o[w[0]]=o[w[0]]||{};o[w[0]][w[1]]=o[w[0]][w[1]]||[];if(o[w[0]][w[1]].indexOf(m)===-1){o[w[0]][w[1]].push(m)}}}}}}return new y().init(j)}},{"./utils":8}],3:[function(f,g,j){var k=f("./imvvmModel");var p=f("./imvvmViewModel");var i=f("./imvvmDomainModel");var r=f("./mixin");var q=f("./utils");var n=q.extend;var m=q.mixInto;var l=function(){};var h=function(){};var o=function(){};m(l,k.Mixin);m(h,p.Mixin);m(o,i.Mixin);var e={createClass:function(u,v,t){var y=function(){};y.prototype=new u();y.prototype.constructor=y;var x=y;var w=function(z){var A=new x();return A.construct.apply(w,arguments)};w.componentConstructor=y;y.ConvenienceConstructor=w;w.originalSpec=t;w.type=y;y.prototype.type=y;w.classType=v;y.prototype.classType=v;return w}};var s={createModel:e.createClass.bind(this,l,"Model"),createViewModel:e.createClass.bind(this,h,"ViewModel"),createDomainModel:e.createClass.bind(this,o,"DomainModel"),mixin:r};g.exports=s},{"./imvvmDomainModel":4,"./imvvmModel":5,"./imvvmViewModel":6,"./mixin":7,"./utils":8}],4:[function(j,h,f){var e=j("./utils");var k=e.extend;var g=e.getDescriptor;var i={Mixin:{construct:function(m){var n=g.call(this);n.proto.setState=m;var l=function(r,o,q){r=r||{};if(!!o){Object.defineProperty(r,"previousState",{configurable:false,enumerable:true,writable:false,value:o})}if(n.originalSpec.getInitialState){r=k(r,n.originalSpec.getInitialState(r,o?o.state:void 0))}n.proto.DataContext=function(t,u,s){return n.proto.setState(t,u,true)};if(!("init" in n.proto)){n.proto.init=function(){return this.DataContext()}}var p=Object.create(n.proto,n.descriptor);r.__proto__=p.__proto__;Object.defineProperty(p,"state",{configurable:false,enumerable:false,writable:false,value:r});return p};return l}}};h.exports=i},{"./utils":8}],5:[function(i,h,f){var e=i("./utils");var k=e.extend;var g=e.getDescriptor;var j={Mixin:{construct:function(m){var n=g.call(this);var l=function(t,o,s){var r=Object.create(n.proto,n.descriptor);var u=arguments.length;var q=typeof Array.prototype.slice.call(arguments,-1)[0]==="boolean";if(u===1){if(q){o=t;t={}}else{o=true}}else{if(u===2){if(!q){s=o;o=true}}else{if(u===3){if(q){var p=o;o=s;s=p}}else{t={};o=true}}}if(n.originalSpec.getInitialState){t=k(t,n.originalSpec.getInitialState(t,s))}if(o){Object.defineProperty(r,"context",{configurable:true,enumerable:true,set:function(v){this.setState=m(v);delete this.context}})}Object.defineProperty(r,"state",{configurable:false,enumerable:false,writable:false,value:t});if(!o){Object.freeze(r)}return r};return l}}};h.exports=j},{"./utils":8}],6:[function(j,i,g){var f=j("./utils");var k=f.extend;var h=f.getDescriptor;var e={Mixin:{construct:function(m){var n=h.call(this);n.proto.setState=m;var l=function(r,q,p){r=r||{};r=k(r,q);if(n.originalSpec.getInitialState){r=k(r,n.originalSpec.getInitialState(r,p))}n.proto.DataContext=l;if(!("init" in n.proto)){n.proto.init=function(){return this.DataContext()}}var o=Object.create(n.proto,n.descriptor);Object.defineProperty(o,"state",{configurable:false,enumerable:false,writable:false,value:r});Object.keys(o).map(function(s){if(Object.prototype.toString.call(this[s])==="[object Object]"&&("context" in this[s])){this[s].context=this;Object.freeze(this[s])}if(Object.prototype.toString.call(this[s])==="[object Array]"){Object.freeze(this[s])}}.bind(o));r.__proto__=o.__proto__;return Object.freeze(r)};return l}}};i.exports=e},{"./utils":8}],7:[function(j,i,h){var f=j("./core");var e="__IMVVM__";var g={stateChangedHandler:function(k,l,m){this.setState({appContext:k},function(){if(typeof m==="function"){if(this.state===null||!("appContext" in this.state)){m(void 0)}else{if(l in this.state.appContext){m(this.state.appContext[l])}else{if(l===e){m(this.state.appContext)}else{m(void 0)}}}}}.bind(this))},getInitialState:function(){var k=f.getInitialState(e,this.props.domainModel,this.props.init,this.props.domain,this.stateChangedHandler,this.props.noUndo);return{appContext:k}}};i.exports=g},{"./core":2}],8:[function(h,g,f){var e={getDescriptor:function(){var k={};var j=this.prototype;for(var i in this.originalSpec){if(this.originalSpec.hasOwnProperty(i)){if("get" in this.originalSpec[i]||"set" in this.originalSpec[i]){if(!("enumerable" in this.originalSpec[i])){this.originalSpec[i].enumerable=true}k[i]=this.originalSpec[i]}else{j[i]=this.originalSpec[i]}}}j.extend=e.extend;return{descriptor:k,proto:j,originalSpec:this.originalSpec||{}}},extend:function(){var j={};for(var l=0;l<arguments.length;l++){var m=arguments[l];for(var k in m){if(m.hasOwnProperty(k)){j[k]=m[k]}}}return j},mixInto:function(j,k){var i;for(i in k){if(!k.hasOwnProperty(i)){continue}j.prototype[i]=k[i]}}};g.exports=e},{}]},{},[1])(1)});