!function(b){if("object"==typeof exports){module.exports=b()}else{if("function"==typeof define&&define.amd){define(b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.IMVVM=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(n,l){if(!k[n]){if(!f[n]){var i=typeof require=="function"&&require;if(!l&&i){return i(n,!0)}if(e){return e(n,!0)}throw new Error("Cannot find module '"+n+"'")}var m=k[n]={exports:{}};f[n][0].call(m.exports,function(o){var p=f[n][1][o];return g(p?p:o)},m,m.exports,c,f,k,h)}return k[n].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(h,g,f){var e=h("./src/imvvm.js");g.exports=e},{"./src/imvvm.js":3}],2:[function(h,g,f){var e=h("./utils");var i=e.extend;f.getInitialState=function(m,n,v,l,j){if(typeof v!=="function"){throw new TypeError()}l===void (0)?true:l;var C,k,u={},s={},y,o,x={},w=[],D,r,q;var z=false;var A;var B=function(H,G){var F={};for(var E in H){if(H.hasOwnProperty(E)){if(Object.prototype.toString.call(H[E])==="[object Object]"){F[E]=H[E]}else{F[E]={};F[E][G]=H[E]}}}return F};var p=function(G,H,Q){if((H===void (0)||H===null||Object.keys(H).length===0)){return}var R={},P={},E=[],N,I,L,F,M,J={},O,K;if(Object.getPrototypeOf(H).constructor.classType==="DomainModel"){R=i(H);P=H.previousState}else{if(G!==m){R[G]=i(u[G],H);R[G]=new s[G](R[G]);R=i(u,R);R.persons.state.$hobbies=new s.hobbies(R.hobbies);R.hobbies.state.$persons=new s.persons(R.persons);if(G==="persons"&&("$persons" in R.hobbies.state)&&!Object.isFrozen(R.hobbies.state)){Object.defineProperty(R.hobbies.state,"$persons",{configurable:true,enumerable:true,get:function(){return u.persons},set:function(S){if(u.hobbies.onWatchedStateChanged){R.hobbies=i(R.hobbies,R.hobbies.onWatchedStateChanged(G,S));R.hobbies=new s.hobbies(R.hobbies);R=i(u,R);R.persons.state.$hobbies=new s.hobbies(R.hobbies);R.hobbies.state.$persons=new s.persons(R.persons)}}})}}else{R=i(u,H)}P=u}R.hobbies.state.$persons=new s.persons(R.persons);R.persons.state.$hobbies=new s.hobbies(R.hobbies);if(!!P){Object.freeze(P)}if(G!==m&&typeof Q==="function"){u=new C(R,P,l);z=true;Q(u[G])}else{u=new C(R,z?P.previousState:P,l);z=false;v(u,G,Q)}Object.freeze(u);Object.freeze(u.state);return u};C=n.call(this,p.bind(this,m));u=new C({},void (0),l,true);D=B(u.getDomainDataContext(),"viewModel");for(var t in D){if(D.hasOwnProperty(t)){s[t]=D[t].viewModel.call(this,p.bind(this,t));u[t]=new s[t]({},true)}}u.persons.state.$hobbies=u.hobbies;u.hobbies.state.$persons=u.persons;u.persons.state.$hobbies=new s.hobbies(u.hobbies);u.hobbies.state.$persons=new s.persons(u.persons);u=new C(u,void (0),l,false);Object.freeze(u.state);return Object.freeze(u)}},{"./utils":8}],3:[function(f,g,j){var k=f("./imvvmModel");var p=f("./imvvmViewModel");var i=f("./imvvmDomainModel");var r=f("./mixin");var q=f("./utils");var n=q.extend;var m=q.mixInto;var l=function(){};var h=function(){};var o=function(){};m(l,k.Mixin);m(h,p.Mixin);m(o,i.Mixin);var e={createClass:function(u,v,t){var y=function(){};y.prototype=new u();y.prototype.constructor=y;var x=y;var w=function(z){var A=new x();return A.construct.apply(w,arguments)};w.componentConstructor=y;y.ConvenienceConstructor=w;w.originalSpec=t;w.type=y;y.prototype.type=y;w.classType=v;y.prototype.classType=v;w.getDescriptor=function(){var D={};var C=this.prototype;var B;var z=[];if("__processedObject__" in this.originalSpec){return this.originalSpec.__processedObject__}for(var A in this.originalSpec){if(this.originalSpec.hasOwnProperty(A)){if("get" in this.originalSpec[A]||"set" in this.originalSpec[A]){this.originalSpec[A].enumerable=true;if("kind" in this.originalSpec[A]){if(this.originalSpec[A].kind==="pseudo"){this.originalSpec[A].enumerable=false}else{if(this.originalSpec[A].kind==="uid"){B=A}else{z.push({fieldName:A,kind:this.originalSpec[A].kind})}}delete this.originalSpec[A].kind}D[A]=this.originalSpec[A]}else{C[A]=this.originalSpec[A]}}}if(!("extend" in C)){C.extend=q.extend}this.originalSpec.__processedObject__={descriptor:D,proto:C,originalSpec:this.originalSpec||{},freezeFields:z,uid:B};return this.originalSpec.__processedObject__};return w}};var s={createModel:e.createClass.bind(this,l,"Model"),createViewModel:e.createClass.bind(this,h,"ViewModel"),createDomainModel:e.createClass.bind(this,o,"DomainModel"),mixin:r};g.exports=s},{"./imvvmDomainModel":4,"./imvvmModel":5,"./imvvmViewModel":6,"./mixin":7,"./utils":8}],4:[function(j,h,f){var e=j("./utils");var k=e.extend;var g=e.getDescriptor;var i={Mixin:{construct:function(m){var n=this.getDescriptor(this);n.proto.setState=m;var l=function(w,u,o,t){var q=n.freezeFields;var r=Object.create(n.proto,n.descriptor);Object.defineProperty(r,"state",{configurable:false,enumerable:false,writable:true,value:w});if(!!o&&!!u){Object.defineProperty(r,"previousState",{configurable:false,enumerable:false,writable:false,value:u})}u=u||{};w=k(w,r);if(t&&("getInitialState" in r)){w=k(w,r.getInitialState.call(r))}var v=Object.keys(w);for(var s=v.length-1;s>=0;s--){if(!(v[s] in r)){r[v[s]]=w[v[s]]}}Object.defineProperty(r,"state",{configurable:false,enumerable:false,writable:false,value:w});for(var p=q.length-1;p>=0;p--){Object.freeze(r[q[p].fieldName])}return r};return l}}};h.exports=i},{"./utils":8}],5:[function(i,h,f){var e=i("./utils");var k=e.extend;var g=e.getDescriptor;var j={Mixin:{construct:function(m){var n=this.getDescriptor(this);n.stateChangedHandler=m;n.proto.__getDescriptor=function(){return n};var l=function(r,o){var s=n.freezeFields;var p=Object.create(n.proto,n.descriptor);if(r===void (0)){o=true}r=r||{};Object.defineProperty(p,"state",{configurable:true,enumerable:true,writable:true,value:r});r=k(r,p);if(o&&("getInitialState" in p)){r=k(r,p.getInitialState.call(p))}Object.defineProperty(p,"state",{configurable:false,enumerable:true,writable:false,value:r});for(var q=s.length-1;q>=0;q--){Object.freeze(p[s[q].fieldName])}return Object.freeze(p)};return l}}};h.exports=j},{"./utils":8}],6:[function(j,i,g){var f=j("./utils");var k=f.extend;var h=f.getDescriptor;var e={Mixin:{construct:function(m){var n=this.getDescriptor(this);n.proto.setState=m;var l=function(s,o){var t=n.freezeFields;var q=Object.create(n.proto,n.descriptor);var u,p;if(s.state){s=k(s.state,s);delete s.state}Object.defineProperty(q,"state",{configurable:false,enumerable:true,writable:true,value:s});if(o&&("getInitialState" in q)){s=k(s,q.getInitialState.call(q));Object.defineProperty(q,"state",{configurable:false,enumerable:true,writable:true,value:s})}for(var r=t.length-1;r>=0;r--){if(t[r].kind==="instance"){if(q[t[r].fieldName]){u=q[t[r].fieldName].__getDescriptor();p=Object.create(u.proto,u.descriptor);Object.defineProperty(p,"state",{configurable:false,enumerable:true,writable:false,value:q[t[r].fieldName].state});p.__proto__.setState=function(v,w){return u.stateChangedHandler.bind(q).call(q,k(this.state,v),this.state,w)}.bind(p);q[t[r].fieldName]=Object.freeze(p)}}else{Object.freeze(q[t[r].fieldName])}}return Object.freeze(q)};return l}}};i.exports=e},{"./utils":8}],7:[function(j,i,h){var f=j("./core");var e="__IMVVM__";var g={stateChangedHandler:function(k,l,m){this.setState({domainDataContext:k},function(){if(typeof m==="function"){if(this.state===null||!("domainDataContext" in this.state)){m(void (0))}else{if(l in this.state.domainDataContext){m(this.state.domainDataContext[l])}else{if(l===e){m(this.state.domainDataContext)}else{m(void (0))}}}}}.bind(this))},getInitialState:function(){var k=f.getInitialState(e,this.props.domainModel,this.stateChangedHandler,this.props.enableUndo);return{domainDataContext:k}}};i.exports=g},{"./core":2}],8:[function(h,g,f){var e={extend:function(){var j={};for(var l=0;l<arguments.length;l++){var m=arguments[l];for(var k in m){if(m.hasOwnProperty(k)){j[k]=m[k]}}}return j},mixInto:function(j,k){var i;for(i in k){if(!k.hasOwnProperty(i)){continue}j.prototype[i]=k[i]}}};g.exports=e},{}]},{},[1])(1)});