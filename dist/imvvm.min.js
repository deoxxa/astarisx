!function(b){if("object"==typeof exports){module.exports=b()}else{if("function"==typeof define&&define.amd){define(b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.IMVVM=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(n,l){if(!k[n]){if(!f[n]){var i=typeof require=="function"&&require;if(!l&&i){return i(n,!0)}if(e){return e(n,!0)}throw new Error("Cannot find module '"+n+"'")}var m=k[n]={exports:{}};f[n][0].call(m.exports,function(o){var p=f[n][1][o];return g(p?p:o)},m,m.exports,c,f,k,h)}return k[n].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(h,g,f){var e=h("./src/imvvm.js");g.exports=e},{"./src/imvvm.js":3}],2:[function(h,g,f){var e=h("./utils");var i=e.extend;f.getInitialState=function(m,u,k,l,v,q){if(typeof v!=="function"){throw new TypeError()}var j=m,y=void 0,p={},w,o={};var r=function(B,G,D){var H=false,E,A;G=G||{};if(B===void 0){A=true;B={}}var C=function(J){var L={},K,I;if("dependsOn" in J){J.dependsOn.forEach(function(M){I={};K=M.property.split(".");K.forEach(function(O,N){if(N===0){I=B[O]}else{I=I?I[O]:void 0}});if("alias" in M){L[M.alias]=I}else{L[K.join("_")]=I}})}return L};for(var F in l){if(l.hasOwnProperty(F)){E=C(l[F]);if(A){B[F]=new p[F](B[F],E,G[F]).init(l[F].initArgs)}else{B[F]=new p[F](B[F],E,G[F])}if(D){if(H&&D.subscribers.indexOf(F)!==-1){E=C(l[D.name]);B[D.name]=new p[D.name](B[D.name],E,G[D.name])}H=H?H:F===D.name}}}return B};var n=function(B,C,J,F){var I,M={},H=void 0,L=void 0,G,E,K;if(B in o){G=Object.keys(C);E=G.length;K={};for(var D=0;D<E;D++){if(o[B][G[D]]){K[o[B][G[D]]]=true}}L={};L.name=B;L.subscribers=Object.keys(K);L=!!L.subscribers.length?L:void 0}var A=!!C?Object.getPrototypeOf(C).constructor.classType==="AppViewModel":false;if(A){M=i(C.state);H=C.state.previousState}else{if(B!==j){M[B]=C;M=i(y.state,M)}else{if(F){M=i(r(),C)}else{M=i(y.state,C)}}H=y;M=r(M,y?y.state:void 0,L)}if(H){Object.freeze(H)}y=new z(M,q?void 0:H);I=Object.freeze(y.state);v(I,J);return I};var z=u.call(this,n.bind(this,j));for(var x in l){if(l.hasOwnProperty(x)){p[x]=l[x].viewModel.call(this,n.bind(this,x));if("dependsOn" in l[x]){for(var s=0,t=l[x].dependsOn.length;s<t;s++){w=l[x].dependsOn[s].property.split(".");if(w.length>1){o[w[0]]=o[w[0]]||{};o[w[0]][w[1]]=o[w[0]][w[1]]||[];if(o[w[0]][w[1]].indexOf(x)===-1){o[w[0]][w[1]].push(x)}}}}}}return new z().init(k)}},{"./utils":6}],3:[function(i,h,g){var j=i("./imvvmBase");var f=i("./mixin");var e={createModel:j.createModel,createViewModel:j.createViewModel,createAppViewModel:j.createAppViewModel,mixin:f};h.exports=e},{"./imvvmBase":4,"./mixin":5}],4:[function(g,h,j){var n=g("./utils");var m=n.extend;var l=n.mixInto;var k=function(){};var i={Mixin:{construct:function(s){var v,o={};var u=this.prototype;var q=this.classType==="Model";var w=this.classType==="ViewModel";var r=this.classType==="AppViewModel";var t=this.originalSpec||{};for(v in this.originalSpec){if(this.originalSpec.hasOwnProperty(v)){if("get" in this.originalSpec[v]||"set" in this.originalSpec[v]){if(!("enumerable" in this.originalSpec[v])){this.originalSpec[v].enumerable=true}o[v]=this.originalSpec[v]}else{u[v]=this.originalSpec[v]}}}if(!q){u.setState=s}u.extend=m;var p=function(C,x,B){if(w){u.DataContext=p;if(!("init" in u)){u.init=function(){return this.DataContext()}}}if(r){u.DataContext=function(F,G,E){return u.setState(F,G,true)};if(!("init" in u)){u.init=function(){return this.DataContext()}}}var A=Object.create(u,o);if(q){var D=arguments.length;var z=typeof Array.prototype.slice.call(arguments,-1)[0]==="boolean";if(D===1){if(z){x=C;C={}}else{x=true}}else{if(D===2){if(!z){B=x;x=true}}else{if(D===3){if(z){var y=x;x=B;B=y}}else{C={};x=true}}}if(t.getInitialState){C=m(C,t.getInitialState(C,B))}if(x){Object.defineProperty(A,"context",{configurable:true,enumerable:true,set:function(E){this.setState=s(E);delete this.context}})}}else{C=C||{};if(w){C=m(C,x);if(t.getInitialState){C=m(C,t.getInitialState(C,B))}Object.defineProperty(A,"state",{configurable:false,enumerable:false,writable:false,value:C});Object.keys(A).map(function(E){if(Object.prototype.toString.call(this[E])==="[object Object]"&&("context" in this[E])){this[E].context=this;Object.freeze(this[E])}}.bind(A));C.__proto__=A.__proto__;return Object.freeze(C)}else{if(!!x){Object.defineProperty(C,"previousState",{configurable:false,enumerable:true,writable:false,value:x})}if(t.getInitialState){C=m(C,t.getInitialState(C,x?x.state:void 0))}C.__proto__=A.__proto__}}Object.defineProperty(A,"state",{configurable:false,enumerable:false,writable:false,value:C});return A}.bind(this);return p}}};l(k,i.Mixin);var f={createClass:function(p,o){var s=function(){};s.prototype=new k();s.prototype.constructor=s;var r=s;var q=function(t){var u=new r();return u.construct.apply(q,arguments)};q.componentConstructor=s;s.ConvenienceConstructor=q;q.originalSpec=o;q.type=s;s.prototype.type=s;q.classType=p;s.prototype.classType=p;return q}};var e={createModel:f.createClass.bind(this,"Model"),createViewModel:f.createClass.bind(this,"ViewModel"),createAppViewModel:f.createClass.bind(this,"AppViewModel")};h.exports=e},{"./utils":6}],5:[function(j,i,h){var f=j("./core");var e="__IMVVM__";var g={stateChangedHandler:function(k,l){this.setState({appContext:k},function(){if(typeof l==="function"){if(this.state!==null&&("appContext" in this.state)){l(this.state.appContext)}else{l(void 0)}}}.bind(this))},getInitialState:function(){var k=f.getInitialState(e,this.props.viewModel,this.props.initArgs,this.props.dataContexts,this.stateChangedHandler,this.props.noUndo);return{appContext:k}}};i.exports=g},{"./core":2}],6:[function(h,g,f){var e={extend:function(){var j={};for(var l=0;l<arguments.length;l++){var m=arguments[l];for(var k in m){if(m.hasOwnProperty(k)){j[k]=m[k]}}}return j},mixInto:function(j,k){var i;for(i in k){if(!k.hasOwnProperty(i)){continue}j.prototype[i]=k[i]}}};g.exports=e},{}]},{},[1])(1)});