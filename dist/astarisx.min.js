!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.Astarisx=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(q,n){if(!k[q]){if(!f[q]){var m=typeof require=="function"&&require;if(!n&&m){return m(q,!0)}if(e){return e(q,!0)}var p=new Error("Cannot find module '"+q+"'");throw p.code="MODULE_NOT_FOUND",p}var i=k[q]={exports:{}};f[q][0].call(i.exports,function(l){var o=f[q][1][l];return g(o?o:l)},i,i.exports,c,f,k,h)}return k[q].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(f,g,e){var h=f("./src/core.js");f("./lib/custom-event-polyfill");g.exports=h},{"./lib/custom-event-polyfill":2,"./src/core.js":5}],2:[function(f,g,e){if(!window.CustomEvent||typeof window.CustomEvent!=="function"){var h=function(j,k){var i;k=k||{bubbles:false,cancelable:false,detail:undefined};i=document.createEvent("CustomEvent");i.initCustomEvent(j,k.bubbles,k.cancelable,k.detail);return i};h.prototype=window.Event.prototype;window.CustomEvent=h}},{}],3:[function(f,g,e){(function(){var o=true;var h="";var l;function p(w,v){if("function"==typeof w){return p("*",w)}if("function"==typeof v){var t=new m(w);for(var u=1;u<arguments.length;++u){p.callbacks.push(t.middleware(arguments[u]))}}else{if("string"==typeof w){p.show(w,v)}else{p.start(w)}}}p.callbacks=[];p.base=function(t){if(0==arguments.length){return h}h=t};p.start=function(u){u=u||{};if(l){return}l=true;if(false===u.dispatch){o=false}if(false!==u.popstate){window.addEventListener("popstate",q,false)}if(false!==u.click){window.addEventListener("click",s,false)}if(!o){return}var t=location.pathname+location.search+location.hash;p.replace(t,null,true,o)};p.stop=function(){l=false;removeEventListener("click",s,false);removeEventListener("popstate",q,false)};p.show=function(w,v,u){var t=new r(w,v);if(false!==u){p.dispatch(t)}if(!t.unhandled){t.pushState()}return t};p.replace=function(w,v,x,u){var t=new r(w,v);t.init=x;if(null==u){u=true}if(u){p.dispatch(t)}t.save();return t};p.dispatch=function(t){var u=0;function v(){var w=p.callbacks[u++];if(!w){return j(t)}w(t,v)}v()};function j(t){var u=window.location.pathname+window.location.search;if(u==t.canonicalPath){return}p.stop();t.unhandled=true;window.location=t.canonicalPath}function r(w,u){if("/"==w[0]&&0!=w.indexOf(h)){w=h+w}var t=w.indexOf("?");this.canonicalPath=w;this.path=w.replace(h,"")||"/";this.title=document.title;this.state=u||{};this.state.path=w;this.querystring=~t?w.slice(t+1):"";this.pathname=~t?w.slice(0,t):w;this.params=[];this.hash="";if(!~this.path.indexOf("#")){return}var v=this.path.split("#");this.path=v[0];this.hash=v[1]||"";this.querystring=this.querystring.split("#")[0]}p.Context=r;r.prototype.pushState=function(){history.pushState(this.state,this.title,this.canonicalPath)};r.prototype.save=function(){history.replaceState(this.state,this.title,this.canonicalPath)};function m(u,t){t=t||{};this.path=u;this.method="GET";this.regexp=n(u,this.keys=[],t.sensitive,t.strict)}p.Route=m;m.prototype.middleware=function(u){var t=this;return function(v,w){if(t.match(v.path,v.params)){return u(v,w)}w()}};m.prototype.match=function(B,w){var A=this.keys,C=B.indexOf("?"),t=~C?B.slice(0,C):B,v=this.regexp.exec(t);if(!v){return false}for(var x=1,y=v.length;x<y;++x){var z=A[x-1];var u="string"==typeof v[x]?decodeURIComponent(v[x]):v[x];if(z){w[z.name]=undefined!==w[z.name]?w[z.name]:u}else{w.push(u)}}return true};function n(w,v,u,t){if(w instanceof RegExp){return w}if(w instanceof Array){w="("+w.join("|")+")"}w=w.concat(t?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(z,B,C,A,x,y){v.push({name:A,optional:!!y});B=B||"";return""+(y?"":B)+"(?:"+(y?B:"")+(C||"")+(x||(C&&"([^/.]+?)"||"([^/]+?)"))+")"+(y||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)");return new RegExp("^"+w+"$",u?"":"i")}function q(u){if(u.state){var t=u.state.path;p.replace(t,u.state)}}function s(w){if(1!=i(w)){return}if(w.metaKey||w.ctrlKey||w.shiftKey){return}if(w.defaultPrevented){return}var t=w.target;while(t&&"A"!=t.nodeName){t=t.parentNode}if(!t||"A"!=t.nodeName){return}var u=t.getAttribute("href");if(t.pathname==location.pathname&&(t.hash||"#"==u)){return}if(t.target){return}if(!k(t.href)){return}var v=t.pathname+t.search+(t.hash||"");var x=v+t.hash;v=v.replace(h,"");if(h&&x==v){return}w.preventDefault();p.show(x)}function i(t){t=t||window.event;return null==t.which?t.button:t.which}function k(u){var t=location.protocol+"//"+location.hostname;if(location.port){t+=":"+location.port}return 0==u.indexOf(t)}if("undefined"==typeof g){window.page=p}else{g.exports=p}})()},{}],4:[function(i,j,h){var g=i("./utils");var l=g.extend;var f=g.isArray;var e=g.isObject;var k={Mixin:{construct:function(o,n){var q=false;var m=false;var r=l(this.getDescriptor());r.proto.setState=o;r.proto.revert=function(){this.setState(this.previousState,!!this.previousState?this:void (0))};r.proto.advance=function(){if(this.canAdvance){this.setState(this.nextState,this.nextState.nextState)}};r.proto.initializeDataContext=function(v){var w=Array.prototype.slice.call(arguments,0);var s;var y={};var A,z,u,x;if(v===void (0)){y={"*":[]}}else{if(f(v)){w=w[0]}s=w.length;for(var t=0;t<s;t++){w[t];if(e(w[t])){for(A in w[t]){if(w[t].hasOwnProperty(A)){if(f(w[t][A])){y[A]=w[t][A]}else{y[A]=w[t][A]===void (0)?[]:[w[t][A]]}}}}else{y[w[t]]=[]}}}u="*" in y?r.viewModels:y;for(z in u){if(u.hasOwnProperty(z)){if((z in this)&&!!this[z].dataContextWillInitialize){x=y[z]||[];x=x.concat(y["*"]||y["_*"]||[]);this[z].dataContextWillInitialize.apply(this[z],x);delete Object.getPrototypeOf(this[z]).dataContextWillInitialize}}}};var p=function(E,B,x,t,F,y,z,A){var w=r.freezeFields,C=Object.create(r.proto,r.descriptor),v,D=E===void (0),s,u;y=F?y:false;if(!D){if(F){u=E.pageNotFound===void (0)?false:E.pageNotFound;Object.defineProperty(C,"pageNotFound",{configurable:false,enumerable:false,writable:false,value:u});Object.defineProperty(C,"forceReplace",{configurable:false,enumerable:false,writable:false,value:E.forceReplace===void (0)?false:E.forceReplace});Object.defineProperty(C,"pushState",{configurable:false,enumerable:true,writable:false,value:E.pushState===void (0)?true:E.pushState});if(!("path" in C)&&("path" in E)){Object.defineProperty(C,"path",{configurable:false,enumerable:true,writable:false,value:E.path})}}if(E.enableUndo===void (0)){s=false}else{t=E.enableUndo;s=E.enableUndo;if(!E.enableUndo){F=false}}}if(t||F){if(!!B&&(!y||s||u)&&!q&&z&&A){q=s;m=u;Object.defineProperty(C,"previousState",{configurable:false,enumerable:false,writable:false,value:B});Object.defineProperty(C,"canRevert",{configurable:false,enumerable:false,writable:false,value:true})}else{Object.defineProperty(C,"canRevert",{configurable:false,enumerable:false,writable:false,value:false})}if(!!x&&("state" in x)&&!q&&!m){Object.defineProperty(C,"nextState",{configurable:false,enumerable:false,writable:false,value:x});Object.defineProperty(C,"canAdvance",{configurable:false,enumerable:false,writable:false,value:true})}else{q=s;m=u;Object.defineProperty(C,"canAdvance",{configurable:false,enumerable:false,writable:false,value:false})}}if(D){E=("getInitialState" in r.originalSpec)?r.originalSpec.getInitialState.call(C):{};if(F){Object.defineProperty(C,"path",{configurable:false,enumerable:true,writable:false,value:E.path||"/"})}}else{if("state" in E){delete E.state;Object.defineProperty(C,"state",{configurable:true,enumerable:false,writable:true,value:E});E=l(E,C)}}for(v=w.length-1;v>=0;v--){if(w[v].kind==="object"){if(e(E[w[v].fieldName])){Object.freeze(E[w[v].fieldName])}}else{if(w[v].kind==="object:freeze"){freeze(E[w[v].fieldName])}else{if(w[v].kind==="object:deepFreeze"){deepFreeze(E[w[v].fieldName])}else{E[w[v].fieldName]=E[w[v].fieldName]||[];if(w[v].kind==="array:freeze"){freeze(E[w[v].fieldName])}else{if(w[v].kind==="array:deepFreeze"){deepFreeze(E[w[v].fieldName])}else{Object.freeze(E[w[v].fieldName])}}}}}}Object.defineProperty(C,"state",{configurable:false,enumerable:false,writable:false,value:E});return C};return p}}};j.exports=k},{"./utils":9}],5:[function(k,f,w){var g=k("./model");var i=k("./viewModel");var r=k("./controllerViewModel");var p=k("./mixin");var j=k("page");var t=k("./utils");var s=t.extend;var h=t.mixInto;var q=t.uuid;var m=function(){};var v=function(){};var n=function(){};var l;var o;var u;h(m,g.Mixin);h(v,i.Mixin);h(n,r.Mixin);var e={createClass:function(y,z,x){var C=function(){};C.prototype=new y();C.prototype.constructor=C;var B=C;var A=function(D){var E=new B();return E.construct.apply(A,arguments)};A.componentConstructor=C;C.ConvenienceConstructor=A;A.originalSpec=x;A.type=C;C.prototype.type=C;A.classType=z;C.prototype.classType=z;A.getDescriptor=function(){var E={},M=this.prototype,O={},F=[],G={},P={},J=false,R,I;var N={},H=[];if("__processedSpec__" in this.originalSpec){return this.originalSpec.__processedSpec__}if("mixins" in this.originalSpec&&M.constructor.classType!=="Model"){for(var L=0;L<this.originalSpec.mixins.length;L++){I=this.originalSpec.mixins[L];for(var D in I){var Q=I[D];if(!I.hasOwnProperty(D)){continue}this.originalSpec[D]=Q}}delete this.originalSpec.mixins}for(R in this.originalSpec){if(this.originalSpec.hasOwnProperty(R)){if("get" in this.originalSpec[R]||"set" in this.originalSpec[R]){N[R]=s(this.originalSpec[R]);if(!("enumerable" in N[R])){N[R].enumerable=true}if(M.constructor.classType==="ControllerViewModel"&&("viewModel" in N[R])){if(R!=="*"&&R!=="_*"){O[R]=N[R].viewModel}delete N[R].viewModel;delete N[R].set}else{if(M.constructor.classType==="Model"&&("aliasFor" in N[R])){G[N[R].aliasFor]=R;delete N[R].aliasFor}if(M.constructor.classType==="Model"&&("validate" in N[R])&&Object.prototype.toString.call(N[R].validate)==="[object Object]"){delete N[R].validate.set;E[R+"Valid"]=N[R].validate;H.push(N[R].validate.get);delete N[R].validate}if("kind" in N[R]){if(N[R].kind==="pseudo"){N[R].enumerable=false}else{if((M.constructor.classType==="ViewModel"&&N[R].kind==="instance")||N[R].kind==="object"||N[R].kind==="object:freeze"||N[R].kind==="object:deepFreeze"||N[R].kind==="array"||N[R].kind==="array:freeze"||N[R].kind==="array:deepFreeze"){F.push({fieldName:R,kind:N[R].kind});delete N[R].set}else{if(M.constructor.classType==="ControllerViewModel"&&N[R].kind==="static"){J=true;P[R]=void (0)}else{if(M.constructor.classType==="Model"&&N[R].kind==="uid"){}else{throw new TypeError('"'+N[R].kind+'" is not a valid "kind" value. Please review field "'+R+'".')}}}}delete N[R].kind}}E[R]=N[R]}else{if(R!=="getInitialState"&&R!=="getWatchedState"&&R!=="getRoutes"&&R!=="getDisplays"&&R!="getTransitions"){M[R]=this.originalSpec[R]}}}}if(M.constructor.classType==="ControllerViewModel"){this.originalSpec.getViewModels=function(){return O}}if(M.constructor.classType==="Model"){var K=H.length;if(K>0){E.allValid={get:function(){var T=true;for(var S=0;S<K;S++){if(!!!H[S].call(this)){T=false;break}}return T}}}}this.originalSpec.__processedSpec__={descriptor:E,proto:M,originalSpec:this.originalSpec||{},freezeFields:F,aliases:G,statics:P,hasStatic:J,viewModels:O};return this.originalSpec.__processedSpec__};return A}};l=e.createClass.bind(this,m,"Model");o=e.createClass.bind(this,v,"ViewModel");u=e.createClass.bind(this,n,"ControllerViewModel");f.exports={createModelClass:l,createMClass:l,createVMClass:o,createViewModelClass:o,createControllerViewModelClass:u,createCVMClass:u,mixin:p,extend:s,uuid:q,page:j}},{"./controllerViewModel":4,"./mixin":6,"./model":7,"./utils":9,"./viewModel":10,page:3}],6:[function(g,e,h){var m=g("./stateManager");var i;var l={ui:{initializeAppContext:function(o,n){i=new m(this,o,n)},componentWillUnmount:function(){if("sessionStorage" in window){window.sessionStorage.clear()}i.dispose()}},view:{getInitialState:function(){return{appContext:i.currentState(),containerType:"view"}},componentDidMount:function(){i.mountView(this)},componentWillUnmount:function(){i.unmountView(this)}},display:{getInitialState:function(){return{containerType:"display"}},componentDidMount:function(){this.props.appContext.cueDisplay(this)}},page:{getInitialState:function(){return{containerType:"page"}},componentDidMount:function(){this.props.appContext.cuePage(this)}},pushState:{componentDidMount:function(){this.getDOMNode().addEventListener("click",this.onclick)},componentWillUnmount:function(){this.getDOMNode().removeEventListener("click")},which:function(n){n=n||window.event;return null==n.which?n.button:n.which},sameOrigin:function(o){var n=location.protocol+"//"+location.hostname;if(location.port){n+=":"+location.port}return 0==o.indexOf(n)},onclick:function(q){if(1!=this.which(q)){return}if(q.metaKey||q.ctrlKey||q.shiftKey){return}if(q.defaultPrevented){return}var n=q.target;while(n&&"A"!=n.nodeName){n=n.parentNode}if(!n||"A"!=n.nodeName){return}var o=n.getAttribute("href");if(n.pathname==location.pathname&&(n.hash||"#"==o)){return}if(n.target){return}if(!this.sameOrigin(n.href)){return}var p=n.pathname+n.search+(n.hash||"");var r=p+n.hash;q.preventDefault();p=p.replace(Astarisx.page.base(),"");if(Astarisx.page.base()&&r==p||n.href===n.baseURI+n.search+(n.hash||"")){return}Astarisx.page.show(r)}},mediaQuery:{mediaChangeHandler:function(p,n,o){i.currentState().mediaChangeHandler.call(i.currentState(),p,n,o)},componentDidMount:function(){var s=document.styleSheets;var o=s.length;var r=true;var u,v,t,n;for(var q=0;q<o;q+=1){u=s[q].cssRules;v=u.length;for(var p=0;p<v;p+=1){if(u[p].constructor===CSSMediaRule){if(!!u[p].cssRules.length){n=u[p].cssRules[0].selectorText.split("#");if(n.length===2&&n[0]===".media"){t=window.matchMedia(u[p].media.mediaText);t.addListener(this.mediaChangeHandler.bind(this,n[1]));if(r){this.mediaChangeHandler(n[1],t,r)}else{this.mediaChangeHandler(t)}}}}}}}}};var j={getInitialState:function(){return{appContext:i.currentState(),containerType:"display"}},componentDidMount:function(){i.mountView(this);this.state.appContext.cueDisplay(this)},componentWillUnmount:function(){i.unmountView(this)}};var k={getInitialState:function(){return{appContext:i.currentState(),containerType:"page"}},componentDidMount:function(){i.mountView(this);this.state.appContext.cuePage(this)},componentWillUnmount:function(){i.unmountView(this)}};var f=l.view;Object.defineProperty(l.view,"display",{configurable:false,enumerable:false,writable:false,value:j});Object.defineProperty(l.view,"page",{configurable:false,enumerable:false,writable:false,value:k});e.exports=l},{"./stateManager":8}],7:[function(g,h,f){var e=g("./utils");var j=e.extend;var i={Mixin:{construct:function(k){var m=this.getDescriptor();var l=function(r,p,n){var s=m.freezeFields,q,o=Object.create(m.proto,m.descriptor);if(r===void (0)){n=true}else{if(typeof r==="boolean"){n=r;r=void (0)}else{if(typeof p==="boolean"){n=p;p=void (0)}}}r=j(r,p);Object.defineProperty(o,"state",{configurable:true,enumerable:false,writable:true,value:r});r=j(r,o);if(n){for(var t in m.aliases){if(m.aliases.hasOwnProperty(t)&&t in r){r[m.aliases[t]]=r[t];delete r[t]}}Object.defineProperty(o,"state",{configurable:true,enumerable:false,writable:true,value:r});r=j(r,o);if("getInitialState" in m.originalSpec){r=j(r,m.originalSpec.getInitialState.call(o))}}for(q=s.length-1;q>=0;q--){if(s[q].kind==="object"){if(isObject(r[s[q].fieldName])){Object.freeze(r[s[q].fieldName])}}else{if(s[q].kind==="object:freeze"){freeze(r[s[q].fieldName])}else{if(s[q].kind==="object:deepFreeze"){deepFreeze(r[s[q].fieldName])}else{r[s[q].fieldName]=r[s[q].fieldName]||[];if(s[q].kind==="array:freeze"){freeze(r[s[q].fieldName])}else{if(s[q].kind==="array:deepFreeze"){deepFreeze(r[s[q].fieldName])}else{Object.freeze(r[s[q].fieldName])}}}}}}Object.defineProperty(o,"state",{configurable:false,enumerable:false,writable:false,value:r});Object.defineProperty(o,"__stateChangeHandler",{configurable:false,enumerable:false,writable:false,value:(function(){return k})()});return Object.freeze(o)};return l}}};h.exports=i},{"./utils":9}],8:[function(g,f,h){var k=g("page");var n=g("./utils");var j=n.extend;var m=n.updateStatic;var e=n.uuid;var i=n.isArray;var l=n.isControllerViewModel;var o=function(F,K,L){var G=e(),P,N,p,M,t,U,A={},E=false,B={},V,s={},R={},v,z={},x={},O,J,S,C,y,r=false,H={},T={},q,w=false,D=false,I=this;I.appState={};I.listeners={};I.handlers={};I.hasListeners=false;P=K.controllerViewModel;t="enableUndo" in K?K.enableUndo:false;U="enableRouting" in K?K.enableRouting:false;I.signInUrl=K.signInUrl;N=function(W){F.setState({appContext:W})};var u=function(ap,W,X,ai,ac,at){var af={},ad=void (0),au=void (0),ah,ae,aa,ag,aj,ar=[],al,am,Z,ak,Y=false,ab=false,an;console.log(W);if(arguments.length<2){W=I.appState}if(typeof ai==="function"){at=ac;ac=ai;ai=true}else{if(typeof X==="function"){at=ai;ac=X;X={}}else{if(typeof X==="boolean"){ai=X;X={}}}}if(ai===void (0)){ai=true}W=W||{};ah=Object.keys(W);if(l(W)){ab=true;af=j(W,A);ad=W.previousState;au=X;for(ag in V){af[ag]=new B[ag](af[ag])}for(ag in V){if(V.hasOwnProperty(ag)){for(aj in s[ag]){if(s[ag].hasOwnProperty(aj)){af[ag].state[s[ag][aj]]=(aj in V)?j(af[aj].state):af[aj]}}}}if(typeof ac==="function"){try{I.appState=new this.ApplicationDataContext(af,ad,au,t,U,af.path!==I.appState.path,!w||af.pageNotFound,ai);r=true;if(!!at){window.setTimeout(function(){if(ap===G){ac.call(I.appState,void (0),I.appState)}else{ac.call(I.appState[ap],void (0),I.appState)}},at)}else{if(ap===G){ac.call(I.appState,void (0),I.appState)}else{ac.call(I.appState[ap],void (0),I.appState)}}}catch(aq){ac(aq)}return}}else{if(E){A=m(A,W)}if(!!ah.length){if(ap===G){af=j(W)}else{af[ap]=j(W)}}z=j(af,z,X);transientStateKeys=Object.keys(z);if(transientStateKeys.length===0){return}aa=transientStateKeys.length-1;for(ae=aa;ae>=0;ae--){if(transientStateKeys[ae] in V){af[transientStateKeys[ae]]=j(I.appState[transientStateKeys[ae]],z[transientStateKeys[ae]]);af[transientStateKeys[ae]]=new B[transientStateKeys[ae]](af[transientStateKeys[ae]])}else{af[transientStateKeys[ae]]=z[transientStateKeys[ae]]}}x=j(x,af);af=j(I.appState,x);z={};for(ae=aa;ae>=0;ae--){if(transientStateKeys[ae] in R){for(am in R[transientStateKeys[ae]]){if(R[transientStateKeys[ae]].hasOwnProperty(am)){if(ah.indexOf(am)!==-1){Z=R[transientStateKeys[ae]][am];for(ak in Z){if(Z.hasOwnProperty(ak)){if(ak in s){for(ag in s[ak]){if(s[ak].hasOwnProperty(ag)){af[ak].state[s[ak][ag]]=(ag in V)?j(af[ag].state):af[ag]}if(ag in s){for(dataContext2 in s[ag]){if(s[ag].hasOwnProperty(dataContext2)){af[ag].state[s[ag][dataContext2]]=(dataContext2 in V)?j(af[dataContext2].state):af[dataContext2]}}}}}z=j(z,Z[ak].call(I.appState[ak],af[transientStateKeys[ae]][am],I.appState[transientStateKeys[ae]][am],am,transientStateKeys[ae],af.path,I.appState.path))}}}}}}}if(!!Object.keys(z).length){u(void (0),{},z,ai,ac,at);return}ar=Object.keys(x);al=ar.length-1;for(ae=al;ae>=0;ae--){if(ap===G&&(G in s)){if(ar[ae] in s[G]){for(ag in s[G][ar[ae]]){if(s[G][ar[ae]].hasOwnProperty(ag)){af[ag].state[s[G][ar[ae]][ag]]=af[ar[ae]]}if(ag in s){for(dataContext2 in s[ag]){if(s[ag].hasOwnProperty(dataContext2)){af[ag].state[s[ag][dataContext2]]=(dataContext2 in V)?j(af[dataContext2].state):af[dataContext2]}}}}}}else{if(ar[ae] in s){for(ag in s[ar[ae]]){if(s[ar[ae]].hasOwnProperty(ag)){af[ar[ae]].state[s[ar[ae]][ag]]=af[ag]}if(ag in s){for(dataContext2 in s[ag]){if(s[ag].hasOwnProperty(dataContext2)){af[ag].state[s[ag][dataContext2]]=af[dataContext2]}}}}}}}if(I.appState.canRevert&&r){ad=I.appState.previousState}else{if(E&&A._staticUpdated&&A._onlyStatic){if(I.appState.canRevert){ad=I.appState.previousState}if(I.appState.canAdvance){au=I.appState.nextState}}else{ad=I.appState}}}if(!!ad){Object.freeze(ad)}Y=af.path!==I.appState.path;try{if(ab){af=j(af,{dataContextWillUpdate:W.state.dataContextWillUpdate})}else{af=j(af,{dataContextWillUpdate:x})}I.appState=new this.ApplicationDataContext(af,ad,au,t,U,Y,!w||af.pageNotFound,ai);Object.freeze(I.appState);Object.freeze(I.appState.state);if(typeof ac==="function"){r=true;if(!!at){window.setTimeout(function(){if(ap===G){ac.call(I.appState,void (0),I.appState)}else{ac.call(I.appState[ap],void (0),I.appState)}},at)}else{if(ap===G){ac.call(I.appState,void (0),I.appState)}else{ac.call(I.appState[ap],void (0),I.appState)}return}}}catch(aq){if(typeof ac==="function"){ac(aq);return}}if(U&&I.appState.pushState){if(("path" in I.appState)&&!w){D=true;if(Y&&!I.appState.forceReplace){k(I.appState.path)}else{k.replace(I.appState.path)}}w=false}r=false;z={};x={};if(I.hasListeners){an=new CustomEvent("stateChange",{detail:I.appState});if(af.notify){if(i(af.notify)){af.notify.forEach(function(av){if(av==="*"){N(I.appState)}else{if(av in I.listeners){I.listeners[av].dispatchEvent(an)}}})}else{if(af.notify==="*"){N(I.appState)}else{if(af.notify in I.listeners){I.listeners[af.notify].dispatchEvent(an)}}}}else{N(I.appState);for(var ao in I.listeners){if(I.listeners.hasOwnProperty(ao)){I.listeners[ao].dispatchEvent(an)}}}an=void (0)}else{N(I.appState)}};try{this.ApplicationDataContext=P.call(this,u.bind(this,G));I.appState=new this.ApplicationDataContext(void (0),void (0),void (0),t,U);I.appState.state=I.appState.state||{}}catch(Q){if(Q instanceof TypeError){throw new TypeError('Please assign a ControllerViewModel to the "controllerViewModel" prop in React.renderComponent')}else{throw Q}}V=I.appState.constructor.originalSpec.getViewModels();delete Object.getPrototypeOf(I.appState).getViewModels;for(v in V){if(V.hasOwnProperty(v)){B[v]=V[v].call(this,u.bind(this,v));I.appState.state[v]=new B[v](I.appState.state[v],true)}}for(v in V){if(V.hasOwnProperty(v)){if("getWatchedState" in I.appState[v].constructor.originalSpec){O=I.appState[v].constructor.originalSpec.getWatchedState();for(J in O){if(O.hasOwnProperty(J)){if(J in V||J in I.appState){if("alias" in O[J]){if(!(v in s)){s[v]={}}s[v][J]=O[J].alias;if(!(J in V)){if(!(G in s)){s[G]={}}if(!(v in s[G])){s[G][J]={}}s[G][J][v]=O[J].alias}}for(S in O[J].fields){if(O[J].fields.hasOwnProperty(S)){if(J in V){C={};if(!(J in R)){R[J]={}}C[S]={};C[S][v]=O[J].fields[S];R[J]=C}}}}}}}}}for(v in V){if(V.hasOwnProperty(v)){for(y in s[v]){if(s[v].hasOwnProperty(y)){I.appState[v].state[s[v][y]]=I.appState[y]}}}}for(v in V){if(V.hasOwnProperty(v)){I.appState.state[v]=new B[v](I.appState.state[v]);if("getRoutes" in I.appState[v].constructor.originalSpec){H=I.appState[v].constructor.originalSpec.getRoutes();for(q in H){if(H.hasOwnProperty(q)){T[H[q].path]=H[q].handler;k(H[q].path,function(Z,Y,W,X){w=true;if(!D){if(I.appState.canRevert&&I.appState.pageNotFound){X.rollbackRequest=true;X.revert=function(){this.revert.bind(this);this.setState({},{path:X.path})}.bind(I.appState)}T[Y].call(I.appState[Z],X.params,X.path,W,X,("show" in I.appState)?I.appState.show.bind(I.appState):void (0))}D=false}.bind(this,v,H[q].path,q))}}delete Object.getPrototypeOf(I.appState[v]).getRoutes}if("getDisplays" in I.appState[v].constructor.originalSpec){I.appState.addDisplays(I.appState[v].constructor.originalSpec.getDisplays(),v);delete Object.getPrototypeOf(I.appState[v]).getDisplays}}}if("getDisplays" in I.appState.constructor.originalSpec){I.appState.addDisplays(I.appState.constructor.originalSpec.getDisplays());delete Object.getPrototypeOf(I.appState).getDisplays}delete Object.getPrototypeOf(I.appState).addDisplays;if("getTransitions" in I.appState.constructor.originalSpec){I.appState.addTransitions(I.appState.constructor.originalSpec.getTransitions());delete Object.getPrototypeOf(I.appState).getTransitions}delete Object.getPrototypeOf(I.appState).addTransitions;I.appState=new this.ApplicationDataContext(I.appState,void (0),void (0),t,U);if(U){k(function(W){w=true;I.appState.setState({pageNotFound:true});D=false});D=true;k.replace(I.appState.path);k.start({click:false,dispatch:false});w=false}E=I.appState.constructor.originalSpec.__processedSpec__.hasStatic;if(E){A=m(I.appState.constructor.originalSpec.__processedSpec__.statics,I.appState.state)}Object.freeze(I.appState.state);Object.freeze(I.appState);if("dataContextWillInitialize" in I.appState.constructor.originalSpec){I.appState.constructor.originalSpec.dataContextWillInitialize.call(I.appState,L);delete Object.getPrototypeOf(I.appState).dataContextWillInitialize}};o.prototype.currentState=function(){return this.appState};o.prototype.unmountView=function(p){var q=p.props.viewKey||p._rootNodeID;if(this.listeners===null||this.listeners===void (0)){this.handlers=null;this.hasListeners=false;return}this.listeners[q].removeEventListener("stateChange",this.handlers[q]);delete this.listeners[q];delete this.handlers[q];if(!!!Object.keys(this.listeners).length){this.hasListeners=false}};o.prototype.mountView=function(p){var r=p.props.viewKey||p._rootNodeID;this.handlers[r]=function(s){p.setState({appContext:s.detail})};var q=p.getDOMNode();this.listeners[r]=!!q?q:document.createElement("div");this.listeners[r].addEventListener("stateChange",this.handlers[r]);this.hasListeners=true};o.prototype.dispose=function(){var q=new this.ApplicationDataContext(void (0),void (0),void (0),false,false);var p={};var r=this.appState.constructor.originalSpec.getViewModels();if(!!this.signInUrl){k.replace(this.signInUrl)}if("resetDisplay" in this.appState){this.appState.resetDisplay()}for(var s in this.listeners){if(this.listeners.hasOwnProperty(s)){this.listeners[s].removeEventListener("stateChange",this.handlers[s])}}for(viewModel in r){if(r.hasOwnProperty(viewModel)){p[viewModel]=this.appState[viewModel].dispose()}}p=j(this.appState,q,p);try{this.appState=new this.ApplicationDataContext(p,void (0),void (0),false,false);this.appState.state=this.appState.state||{}}catch(t){if(t instanceof TypeError){throw new TypeError("Something went wrong")}else{throw t}}delete this.appState.constructor.originalSpec.__processedSpec__;for(viewModel in r){if(r.hasOwnProperty(viewModel)){delete this.appState[viewModel].constructor.originalSpec.__processedSpec__}}this.listeners=null;this.handlers=null;this.hasListeners=false};f.exports=o},{"./utils":9,page:3}],9:[function(g,h,f){var i=Object.prototype.toString;var e={extend:function(){var j={};for(var l=0;l<arguments.length;l++){var m=arguments[l];for(var k in m){if(m.hasOwnProperty(k)){j[k]=m[k]}}}return j},updateStatic:function(){var j={};Object.defineProperty(j,"_onlyStatic",{configurable:false,enumerable:false,writable:true,value:true});Object.defineProperty(j,"_staticUpdated",{configurable:false,enumerable:false,writable:true,value:false});for(var l=0;l<arguments.length;l++){var m=arguments[l];for(var k in m){if(m.hasOwnProperty(k)&&k in arguments[0]){if(k in arguments[0]){j[k]=m[k];if(l>0){j._staticUpdated=true}}else{j._onlyStatic=false}}}}return j},mixInto:function(k,l){var j;for(j in l){if(!l.hasOwnProperty(j)){continue}k.prototype[j]=l[j]}},uuid:function(){var j,l;var k="";for(j=0;j<32;j++){l=Math.random()*16|0;if(j===8||j===12||j===16||j===20){k+="-"}k+=(j===12?4:(j===16?(l&3|8):l)).toString(16)}return k},isObject:function(j){return i.call(j)==="[object Object]"},isArray:function(j){return i.call(j)==="[object Array]"},isModel:function(j){return Object.getPrototypeOf(j).constructor.classType==="Model"},isViewModel:function(j){return Object.getPrototypeOf(j).constructor.classType==="ViewModel"},isControllerViewModel:function(j){return Object.getPrototypeOf(j).constructor.classType==="ControllerViewModel"},freeze:function(m){if(e.isObject(m)){Object.freeze(m);for(var j in m){if(m.hasOwnProperty(j)){if(e.isArray(m[j])||e.isObject(m[j])){Object.freeze(m[j])}}}}else{if(e.isArray(m)){for(var l=m.length-1;l>=0;l--){if(e.isArray(m[l])||e.isObject(m[l])){Object.freeze(m[l])}}}}},deepFreeze:function(m){if(e.isObject(m)){Object.freeze(m);for(var j in m){if(m.hasOwnProperty(j)){if(e.isArray(m[j])||e.isObject(m[j])){deepFreeze(Object.freeze(m[j]))}}}}else{if(e.isArray(m)){for(var l=m.length-1;l>=0;l--){if(e.isArray(m[l])||e.isObject(m[l])){deepFreeze(Object.freeze(m[l]))}}}}}};h.exports=e},{}],10:[function(g,f,i){var m=g("./utils");var k=m.extend;var n=m.isObject;var j=m.isArray;var h=m.isModel;var e=m.freeze;var l=m.deepFreeze;var o={Mixin:{construct:function(q){var r=this.getDescriptor(this);r.proto.setState=q;var p=function(w,s){w=w||{};w=("state" in w?w.state:w);var x=r.freezeFields,v,u=Object.create(r.proto,r.descriptor),y,t;Object.defineProperty(u,"state",{configurable:true,enumerable:false,writable:true,value:w});if(s){w=("getInitialState" in r.originalSpec)?k(w,r.originalSpec.getInitialState.call(u)):w;Object.defineProperty(u,"state",{configurable:true,enumerable:false,writable:true,value:w})}for(v=x.length-1;v>=0;v--){if(x[v].kind==="instance"){if(u[x[v].fieldName]){y=u[x[v].fieldName].constructor.originalSpec.__processedSpec__;t=Object.create(y.proto,y.descriptor);Object.defineProperty(t,"__stateChangeHandler",{configurable:false,enumerable:false,writable:false,value:(function(z){return u[z].__stateChangeHandler})(x[v].fieldName)});Object.defineProperty(t,"state",{configurable:true,enumerable:false,writable:true,value:u[x[v].fieldName].state});Object.getPrototypeOf(t).setState=function(z,A){A=A?A.bind(this):void (0);this.__stateChangeHandler.call(u,k(this.state,z),A)};Object.freeze(u[x[v].fieldName])}}else{if(x[v].kind==="object"){if(n(w[x[v].fieldName])){Object.freeze(w[x[v].fieldName])}}else{if(x[v].kind==="object:freeze"){e(w[x[v].fieldName])}else{if(x[v].kind==="object:deepFreeze"){l(w[x[v].fieldName])}else{w[x[v].fieldName]=w[x[v].fieldName]||[];if(x[v].kind==="array:freeze"){e(w[x[v].fieldName])}else{if(x[v].kind==="array:deepFreeze"){l(w[x[v].fieldName])}else{Object.freeze(w[x[v].fieldName])}}}}}}}Object.defineProperty(u,"state",{configurable:false,enumerable:false,writable:false,value:w});return Object.freeze(u)};r.proto.dispose=function(){return p(void (0))};return p}}};f.exports=o},{"./utils":9}]},{},[1])(1)});